.\" -*- mode: troff; coding: UTF-8 -*-
.\" (C)Copyright 1999-2003 Marvell(R) -- linux@syskonnect.de
.\" sk98lin.4 1.1 2003/12/17 10:03:18
.\"
.\" %%%LICENSE_START(GPLv2+_DOC_FULL)
.\" This is free documentation; you can redistribute it and/or
.\" modify it under the terms of the GNU General Public License as
.\" published by the Free Software Foundation; either version 2 of
.\" the License, or (at your option) any later version.
.\"
.\" The GNU General Public License's references to "object code"
.\" and "executables" are to be interpreted as the output of any
.\" document formatting or typesetting system, including
.\" intermediate and printed output.
.\"
.\" This manual is distributed in the hope that it will be useful,
.\" but WITHOUT ANY WARRANTY; without even the implied warranty of
.\" MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
.\" GNU General Public License for more details.
.\"
.\" You should have received a copy of the GNU General Public
.\" License along with this manual;if not, see
.\" <http://www.gnu.org/licenses/>.
.\" %%%LICENSE_END
.\"
.\" This manpage can be viewed using `groff -Tascii -man sk98lin.4 | less`
.\"
.\"*******************************************************************
.\"
.\" This file was generated with po4a. Translate the source file.
.\"
.\"*******************************************************************
.TH SK98LIN 4 2017\-09\-15 Linux "Руководство программиста Linux"
.SH ИМЯ
sk98lin \- драйвер Marvell/SysKonnect Gigabit Ethernet, версия 6.21
.SH ОБЗОР
\fBinsmod sk98lin.o\fP [\fBSpeed_A=\fP\fIi,j,...\fP] [\fBSpeed_B=\fP\fIi,j,...\fP]
[\fBAutoNeg_A=\fP\fIi,j,...\fP] [\fBAutoNeg_B=\fP\fIi,j,...\fP] [\fBDupCap_A=\fP\fIi,j,...\fP]
[\fBDupCap_B=\fP\fIi,j,...\fP] [\fBFlowCtrl_A=\fP\fIi,j,...\fP]
[\fBFlowCtrl_B=\fP\fIi,j,...\fP] [\fBRole_A=\fP\fIi,j,...\fP] [\fBRole_B=\fP\fIi,j,...\fP]
[\fBConType=\fP\fIi,j,...\fP] [\fBModeration=\fP\fIi,j,...\fP]
[\fBIntsPerSec=\fP\fIi,j,...\fP] [\fBPrefPort=\fP\fIi,j,...\fP] [\fBRlmtMode=\fP\fIi,j,...\fP]
.SH ОПИСАНИЕ
.ad l
.hy 0
\fBЗамечание\fP: Данный устаревший драйвер был удалён из ядра версии 2.6.26.
.PP
\fBsk98lin\fP — это драйвер Gigabit Ethernet для сетевых адаптеров Marvell и
SysKonnect. Он поддерживает SysKonnect SK\-98xx/SK\-95xx\-совместимые адаптеры
Gigabit Ethernet и любые карты с Yukon\-совместимым чипсетом.
.PP
При загрузке драйвера с помощью insmod, параметры сетевого адаптера можно
указать в командной строке через запятую. Если, например, установлено два
сетевых адаптера и AutoNegotiation на порту A первого адаптера нужно
включить, а на порту A второго адаптера — выключить, то введите следующее:
.PP
   insmod sk98lin.o AutoNeg_A=On,Off
.PP
После того как \fBsk98lin\fP подхватит один или более адаптер и будет
смонтирована файловая система \fI/proc\fP, будут созданы отдельные файлы
статистики в каталоге \fI/proc/net/sk98lin\fP для каждого  порта установленных
сетевых адаптеров. Эти файлы будут называться \fIeth[x]\fP, где \fIx\fP — номер
интерфейса, который был назначен каждому порту в системе.
.PP
После завершения загрузки каждому \fIeth[x]\fP может быть назначен желаемый
IP\-адрес с помощью команды \fBifconfig\fP(8). Это заставит адаптер подключиться
к Ethernet и вывести сообщение на консоль: "ethx: network connection up
using port y" с настроенными или определёнными параметрами подключения.
.PP
Драйвер \fBsk98lin\fP также поддерживает большие фреймы (также называемые jumbo
фреймами). С помощью jumbo\-фреймов можно очень сильно увеличить пропускную
способность при передаче больших объёмов данных. Чтобы включить большие
фреймы, нужно на интерфейсе установить большое значение MTU (максимальная
единица передачи). Значение MTU по умолчанию равно 1500 и может быть
увеличено до 9000 (байт). Установку размера MTU можно выполнить при
назначении IP\-адреса интерфейсу или позднее с помощью команды \fBifconfig\fP(8)
с параметром mtu. Если, например, eth0 нужно назначить IP\-адрес и большой
размер фрейма MTU, то это можно сделать с помощью следующих двух команд:
.PP
    ifconfig eth0 10.1.1.1
    ifconfig eth0 mtu 9000
.PP
Эти две команды можно объединить в одну:
.PP
    ifconfig eth0 10.1.1.1 mtu 9000
.PP
Заметим, что большие фреймы можно использовать только, если эта позволяет
ваша сетевая инфраструктура. Это означает, что все коммутаторы сети Ethernet
также должны поддерживать большие фреймы. Довольно много коммутаторов
поддерживают большие фреймы, но для этого их нужно настроить. В большинстве
случаев, в настройках по умолчанию используются только стандартные фреймы с
размером MTU равным 1500 (байт). Помимо коммутатором сети, все используемые
сетевые адаптеры также должны принимать jumbo\-фреймы. Если адаптер не
настроен для приёма больших фреймов, то он их просто отбрасывает.
.PP
Для переключения обратно к стандартному размеру фрейма Ethernet можно
использовать такую команду \fBifconfig\fP(8):
.PP
    ifconfig eth0 mtu 1500
.PP
Драйвер Marvell/SysKonnect Gigabit Ethernet для Linux поддерживает VLAN и
объединение каналов в соответствии со стандартами IEEE 802.1, 802.1q и
802.3ad. Эти свойства доступны только после установки открытых модулей,
которые можно найти в Интернет:
.PP
\fIVLAN\fP:
.UR http://www.candelatech.com\:/~greear\:/vlan.html
.UE
.br
\fILink\fP \fIAggregation\fP:
.UR http://www.st.rim.or.jp\:/~yumo
.UE
.PP
Заметим, что Marvell/SysKonnect не предлагает поддержку этих открытых
модулей и не несёт ответственности при отказах и проблемах, связанных с
использованием этих модулей.
.SS Параметры
.TP 
\fBSpeed_A=\fP\fIi,j,...\fP
Этот параметр используется для задания скорости порта A. Работает только для
адаптеров Yukon с медным интерфейсом. Возможные значения: \fI10\fP, \fI100\fP,
\fI1000\fP или \fIAuto\fP; по умолчанию задано \fIAuto\fP. Обычно, скорость
согласуется между двумя портами во время установки связи. Если процедура
завершается неудачно, то порт можно принудительно перевести на нужную
скорость с помощью этого параметра.
.TP 
\fBSpeed_B=\fP\fIi,j,...\fP
Этот параметр используется для задания скорости порта B. Работает только для
адаптеров Yukon с медным интерфейсом. Возможные значения: \fI10\fP, \fI100\fP,
\fI1000\fP или \fIAuto\fP; по умолчанию задано \fIAuto\fP. Обычно, скорость
согласуется между двумя портами во время установки связи. Если процедура
завершается неудачно, то порт можно принудительно перевести на нужную
скорость с помощью этого параметра.
.TP 
\fBAutoNeg_A=\fP\fIi,j,...\fP
Включение или выключение автосогласования на порту A. Возможные значения:
\fIOn\fP, \fIOff\fP или \fISense\fP; по умолчанию задано \fIOn\fP. В режиме \fISense\fP
выполняется автоматическое обнаружение поддержки автосогласования у партнёра
по связи.
.TP 
\fBAutoNeg_B=\fP\fIi,j,...\fP
Включение или выключение автосогласования на порту B. Возможные значения:
\fIOn\fP, \fIOff\fP или \fISense\fP; по умолчанию задано \fIOn\fP. В режиме \fISense\fP
выполняется автоматическое обнаружение поддержки автосогласования у партнёра
по связи.
.TP 
\fBDupCap_A=\fP\fIi,j,...\fP
Этот параметр используется для задания режима дуплекса на порту A. Возможные
значения: \fIHalf\fP, \fIFull\fP или \fIBoth\fP; по умолчанию задано \fIBoth\fP. Этот
параметр учитывается только, если AutoNeg_A для порта A не установлено в
\fISense\fP. Если значение AutoNeg_A равно \fIOn\fP, то может быть указано любое
из трёх значений DupCap_A ( \fIHalf\fP, \fIFull\fP или \fIBoth\fP). Если AutoNeg_A
равно \fIOff\fP, то значениями DupCap_A могут быть только \fIFull\fP и
\fIHalf\fP. Параметр DupCap_A полезен, если партнёр по связи не поддерживает
все возможные комбинации дуплекса.
.TP 
\fBDupCap_B=\fP\fIi,j,...\fP
Этот параметр используется для задания режима дуплекса на порту B. Возможные
значения: \fIHalf\fP, \fIFull\fP или \fIBoth\fP; по умолчанию задано \fIBoth\fP. Этот
параметр учитывается только, если AutoNeg_B для порта B не установлено в
\fISense\fP. Если значение AutoNeg_B равно \fIOn\fP, то может быть указано любое
из трёх значений  DupCap_B ( \fIHalf\fP, \fIFull\fP или \fIBoth\fP). Если AutoNeg_B
равно \fIOff\fP, то значениями DupCap_B могут быть только \fIFull\fP и
\fIHalf\fP. Параметр DupCap_B полезен, если партнёр по связи не поддерживает
все возможные комбинации дуплекса.
.TP 
\fBFlowCtrl_A=\fP\fIi,j,...\fP
Этот параметр используется для задания свойств управления потоком, которые
анонсируются портом при автосогласовании. Возможные значения: \fISym\fP,
\fISymOrRem\fP, \fILocSend\fP или \fINone\fP; по умолчанию задано
\fISymOrRem\fP. Назначение режимов:
.IP
\fISym\fP
= Symmetric
 Оба партнёра по связи позволяют посылать фреймы PAUSE.
.br
\fISymOrRem\fP
= SymmetricOrRemote
 Оба или только один партнёр по связи позволяет посылать фреймы PAUSE.
.br
\fILocSend\fP
= LocalSend
 Только локальная связь партнёра позволяет посылать фреймы PAUSE.
.br
\fINone\fP
= None
  Партнёры по связи не позволяют посылать фреймы PAUSE.
.IP
Заметим, что этот параметр игнорируется, если значение AutoNeg_A равно
\fIOff\fP.
.TP 
\fBFlowCtrl_B=\fP\fIi,j,...\fP
Этот параметр используется для задания свойств управления потоком, которые
анонсируются портом при автосогласовании. Возможные значения: \fISym\fP,
\fISymOrRem\fP, \fILocSend\fP или \fINone\fP; по умолчанию задано
\fISymOrRem\fP. Назначение режимов:
.IP
\fISym\fP
= Symmetric
 Оба партнёра по связи позволяют посылать фреймы PAUSE.
.br
\fISymOrRem\fP
= SymmetricOrRemote
 Оба или только один партнёр по связи позволяет посылать фреймы PAUSE.
.br
\fILocSend\fP
= LocalSend
 Только локальная связь партнёра позволяет посылать фреймы PAUSE.
.br
\fINone\fP
= None
  Партнёры по связи не позволяют посылать фреймы PAUSE.
.br
.IP
Заметим, что этот параметр игнорируется, если значение AutoNeg_B равно
\fIOff\fP.
.TP 
\fBRole_A=\fP\fIi,j,...\fP
Этот параметр доступен только для адаптеров 1000Base\-T. При организации
связи между двумя портами 1000Base\-T один должен играть роль основного
(предоставлять синхронизацию), другой — подчинённого. Возможные значения:
\fIAuto\fP, \fIMaster\fP или \fISlave\fP; по умолчанию задано \fIAuto\fP. Обычно, роль
порта согласуется во время установления связи, но если этого достичь не
удалось, с помощью этого параметра порту A можно принудительно назначить
нужное значение.
.TP 
\fBRole_B=\fP\fIi,j,...\fP
Этот параметр доступен только для адаптеров 1000Base\-T. При организации
связи между двумя портами 1000Base\-T один должен играть роль основного
(предоставлять синхронизацию), другой — подчинённого. Возможные значения:
\fIAuto\fP, \fIMaster\fP или \fISlave\fP; по умолчанию задано \fIAuto\fP. Обычно, роль
порта согласуется во время установления связи, но если этого достичь не
удалось, с помощью этого параметра порту B можно принудительно назначить
нужное значение.
.TP 
\fBConType=\fP\fIi,j,...\fP
Этот параметр представляет собой комбинацию всех пяти параметров порта. Он
упрощает настройку обоих портов адаптера. Различные значения этой переменной
отражают большую часть важных комбинаций параметров порта. Возможные
значения и их соответствующие комбинации параметров портов:
.IP
.nf
ConType | DupCap   AutoNeg   FlowCtrl   Role   Speed
\-\-\-\-\-\-\-\-+\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-
\fIAuto\fP    |  Both      On      SymOrRem   Auto   Auto
\fI100FD\fP   |  Full      Off       None     Auto   100
\fI100HD\fP   |  Half      Off       None     Auto   100
\fI10FD\fP    |  Full      Off       None     Auto   10
\fI10HD\fP    |  Half      Off       None     Auto   10
.fi
.IP
Задание любого другого параметра порта вместе с \fIConType\fP приводит к
объединению обеих настроек. Одиночные параметры порта (например, \fISpeed_A\fP)
имеют больший приоритет чем значение переменной \fIConType\fP.
.TP 
\fBModeration=\fP\fIi,j,...\fP
Регулирование прерываний используется для ограничения максимального
количества прерываний, которое может обработать драйвер. То есть одно и
более прерываний (которые означают обработку передачи или приёма пакета)
ставится в очередь для ожидания обработки драйвером. Параметр \fIIntsPerSec\fP
определяет когда обслуживается очередь (см. далее). Возможные режимы
регулирования: \fINone\fP, \fIStatic\fP или \fIDynamic\fP; по умолчанию задано
\fINone\fP. Назначение режимов:
.IP
\fINone\fP Не выполнять регулирование прерываний для адаптера. Следовательно,
каждое прерывания по передаче или приёму будет обработано немедленно, сразу
после появления на линии прерывания адаптера.
.IP
\fIStatic\fP Выполнять регулирование прерываний для адаптера. Все прерывания по
передаче и приёму ставятся в очередь в ожидании завершения интервала
регулирования. После окончания интервала все прерывания в очереди
обрабатываются одним большим заданием без задержки. Термин \fIStatic\fP
отражает тот факт, что регулирование прерываний всегда включено, независимо
от сетевой загрузки на определённом интерфейсе в данный момент. Кроме того,
длительность интервала регулирования прерываний  имеет постоянную величину,
которая при работающем драйвере никогда не меняется.
.IP
\fIDynamic\fP Регулирование прерываний может применяться к адаптеру в
зависимости от загрузки системы. Если драйвер обнаруживает, что система
очень загружена, то он попытается оградить систему от излишней сетевой
нагрузки, включив регулирование прерываний. Если позднее нагрузка на ЦП
снизится (или если сетевая загрузка станет очень маленькой), то
регулирование прерываний будет автоматически выключено.
.IP
Регулирование прерываний должно использоваться, когда драйвер обрабатывает
много трафика на одном или более интерфейсах, который, как следствие, также
приводит большой нагрузке на ЦП. Применение регулирования при большой
сетевой нагрузке на медленных компьютерах может понизить загрузку ЦП на
20\(en30%.
.IP
Заметим, что отрицательной стороной регулирования прерываний является
увеличение времени на передачу и подтверждение (round\-trip\-time, RTT), так
как постановка в очередь и обслуживание прерываний происходит только через
определённые интервалы.
.TP 
\fBIntsPerSec=\fP\fIi,j,...\fP
Этот параметр определяет длительность любого интервала регулирования
прерываний. Предполагая, что используется регулирование прерываний, при
значении параметра \fIIntsPerSec\fP равном 2000, получается интервал
регулирования прерываний в 500 микросекунд. Возможные значения этого
параметра находятся в диапазоне 30...40000 (прерываний в секунду). Значение
по умолчанию равно 2000.
.IP
Этот параметр используется только, если для сетевого адаптера включено
статическое или динамическое регулирование прерываний. Если регулирование не
применяется, то параметр игнорируется.
.IP
Заметим, что длительность интервала регулирования прерываний нужно выбирать
с осторожностью. На первый взгляд, выбор очень большой длительности
(например, только 100 прерываний в секунду) кажется осмысленным, но это
колоссально увеличит задержку в обработке. С другой стороны, выбор очень
короткого интервала регулирования мог бы компенсировать использование любого
применяемого регулирования.
.TP 
\fBPrefPort=\fP\fIi,j,...\fP
Этот параметр используется для принудительного задания предпочтительного
порта: A или B (на двухпортовых адаптерах). Предпочтительный порт будет
использован когда оба порта, A и B, считаются полностью
взаимозаменяемыми. Возможные значения: \fIA\fP или \fIB\fP; по умолчанию задано
\fIA\fP.
.TP 
\fBRlmtMode=\fP\fIi,j,...\fP
RLMT\-слежение за состоянием порта. Если связь на активном порту пропадает,
то RLMT сразу переключает работу на резервную связь. Виртуальная связь
поддерживается так долго, пока есть не менее одной работающей «физической»
связи. Этот параметр определяет как RLMT должен отслеживать состояние
портов. Возможные значения: \fICheckLinkState\fP, \fICheckLocalPort\fP,
\fICheckSeg\fP или \fIDualNet\fP; по умолчанию задано
\fICheckLinkState\fP. Назначение режимов:
.IP
\fICheckLinkState\fP Проверять только состояние связи: RLMT использует
состояние связи, сообщаемое аппаратурой адаптера для каждого порта, для
определения, можно ли использовать порт для передачи данных в сеть или нет.
.IP
\fICheckLocalPort\fP В этом режиме RLMT отслеживает сетевой путь между двумя
портами адаптера, периодически пересылая пакеты между ними. Для работы этого
режима требуется настройка сети, при которой два порта смогли бы "видеть"
друг друга (то есть, между ними не должно быть маршрутизатора).
.IP
\fICheckSeg\fP Проверять локальный порт и сегментирование: Этот режим
поддерживает те же функции что и CheckLocalPort и вдобавок проверяет
сегментирование сети между портами. Поэтому этот режим может использоваться
только, если в сети установлены коммутаторы Gigabit Ethernet, на которых
настроен протокол Spanning Tree.
.IP
\fIDualNet\fP В этом режиме порты A и B используются как раздельные
устройства. Если у вас адаптер с двумя портами, то порт A будет настроен как
\fIeth[x]\fP, а порт B как \fIeth[x+1]\fP. Оба порта можно использовать независимо
с различающимися IP\-адресами. Настройка выбора предпочтительного порта не
используется. RLMT выключено.
.IP
Заметим, что RLMT\-режимы \fICheckLocalPort\fP и \fICheckLinkState\fP предназначены
для работы в условиях, где сетевой путь между портами существует на одном
адаптере. Более того, они не работают, если адаптеры соединены друг с
другом.
.SH ФАЙЛЫ
.TP 
\fI/proc/net/sk98lin/eth[x]\fP
Файлы статистики для определённого интерфейса адаптера. Содержит общую
информацию о карте адаптера и подробную сводку по всем счётчикам передачи и
приёма.
.TP 
\fI/usr/src/linux/Documentation/networking/sk98lin.txt\fP
Это файл \fIREADME\fP от драйвера \fIsk98lin\fP. В нём содержится подробная
инструкция по установке и описание всех параметров драйвера. Также отмечены
общие проблемы и их решения.
.SH ДЕФЕКТЫ
.\" .SH AUTHORS
.\" Ralph Roesler \(em rroesler@syskonnect.de
.\" .br
.\" Mirko Lindner \(em mlindner@syskonnect.de
О дефектах сообщайте по адресу: linux@syskonnect.de
.SH "СМОТРИТЕ ТАКЖЕ"
\fBifconfig\fP(8), \fBinsmod\fP(8), \fBmodprobe\fP(8)
