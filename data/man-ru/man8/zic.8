.\" -*- mode: troff; coding: UTF-8 -*-
.\" %%%LICENSE_START(PUBLIC_DOMAIN)
.\" This page is in the public domain
.\" %%%LICENSE_END
.\"
.\"*******************************************************************
.\"
.\" This file was generated with po4a. Translate the source file.
.\"
.\"*******************************************************************
.TH ZIC 8 2019\-03\-06 "" "Системное администрирование Linux"
.SH ИМЯ
zic \- компилятор часовых поясов
.SH ОБЗОР
\fBzic\fP [ \fIпараметр\fP \&… ] [ \fIимя_файла\fP \&… ]
.SH ОПИСАНИЕ
.ie  '\(lq'' .ds lq \&"\"
.el .ds lq \(lq\"
.ie  '\(rq'' .ds rq \&"\"
.el .ds rq \(rq\"
.de  q
\\$3\*(lq\\$1\*(rq\\$2
..
.ie  '\(la'' .ds < <
.el .ds < \(la
.ie  '\(ra'' .ds > >
.el .ds > \(ra
Программа \fBzic\fP читает текст из файла(ов), имя которого задано в командной
строке, и создаёт файлы с информацией о переводе времени. Если \fIимя_файла\fP
равно
.q \- ,
то для чтения используется стандартный ввод.
.SH ПАРАМЕТРЫ
.TP 
\fB\-\-version\fP
Вывод информации о версии и выход из программы.
.TP 
\fB\-\-help\fP
Вывод короткого сообщения об использовании и выход из программы.
.TP 
\fB\-d \fP\fIкаталог\fP
Создавать файлы с информацией о переводе времени в заданном каталоге, а не в
стандартном каталоге, упомянутом далее.
.TP 
\fB\-l \fP\fIчасовой пояс\fP
Использовать \fIчасовой пояс\fP в качестве местного времени. В этом случае
\fIzic\fP поступит так, как если бы входные данные содержали строку
.sp
.ti +.5i
Link	\fIчасовой_пояс\fP		localtime
.TP 
\fB\-p \fP\fIчасовой пояс\fP
Использовать правила \fIчасового пояса\fP при обработке соответствующих
переменных окружения POSIX. В этом случае \fIzic\fP поступит так, как если бы
входные данные содержали строку
.sp
.ti +.5i
Link	\fIчасовой_пояс\fP		posixrules
.TP 
\fB\-L \fP\fIимя файла с високосной секундой\fP
Прочитать информацию о високосной секунде из файла с заданным именем. Если
этот параметр не используется, то в выходном файле информация о високосной
секунде не появится.
.TP 
\fB\-v\fP
Выдавать более подробную информацию и сообщать о следующих ситуациях:
.RS
.PP
Во входных данных указана ссылка на ссылку.
.PP
Год из файла данных выходит за границы диапазона лет, представимого в
значениях вызова \fBtime\fP(2).
.PP
Во входных данных указано время 24:00 или более. До версий 1998 года в
\fBzic\fP запрещено значение времени 24:00, а в версиях до 2007 года запрещены
значения времени более 24:00.
.PP
Правило выходит за начало или конец месяца. До версий \fBzic\fP старше 2004
года это запрещено.
.PP
Выходной файл не содержит полной информации об отдалённом будущем часового
пояса, так как будущее невозможно выразить в виде расширенной строки POSIX
TZ. Например, в 2013 году эта проблема возникла с правилами перехода на
летнее время в Иране для описанного будущего, так как эти правила
основывались на иранском календаре, который невозможно описать.
.PP
В выводе содержатся данные, которые могут неправильно обрабатываться
клиентским кодом со старым форматом вывода \fBzic\fP. Эти проблемы
совместимости относятся только к меткам времени до 1970 года или после
начала 2038 года.
.PP
В аббревиатуре часового пояса содержится менее трёх символов. В POSIX
требуется не менее 3\-х.
.PP
Имя выходного файла содержит байт, не являющийся буквой ASCII,
.q \- ,
.q / ,
или
.q _ ;
оно содержит компонент имени файла, в котором более 14 байт или который
начинается с
.q \- .
.RE
.TP 
\fB\-s\fP
Ограничить значения времени в выходных файлах рамками значений из входных
файлов, то есть со знаком или без знака. Этот параметр можно использовать
для создания SVVS\-совместимых файлов.
.PP
Входные файлы должны быть текстовыми, то есть, состоять из
последовательностей нуля и более строк, каждая из которых заканчивается
байтом новой строки, содержит не более 511 байт и не содержит байтов
NUL. Кодировка входного текста, обычно, UTF\-8 или ASCII; в ней должно быть
юнибайтовое представление переносимого набора символов POSIX (PPCS)
(http://pubs\:.opengroup\:.org/\:onlinepubs/\:9699919799/\:basedefs/\:V1_chap06\:.html)
и кодирование не юнибайтовых символов должно быть полностью из байт не
PPCS. Не PPCS символы, обычно, встречаются только в комментариях: хотя имена
выходных файлов и сокращения часовых поясов могут содержать практически
любые символы, другое ПО будет работать лучше, если здесь ограничиться
синтаксисом, описанным в параметре \fB\-v\fP.
.PP
Входные строки состоят из полей. Поля отделяются друг от друга одним или
более пробельным символом. Пробельными символами являются пробел, прогон
страницы, возврат каретки, символ новой строки, табуляция и вертикальная
табуляция. Начальные и конечные пробелы входных строк игнорируются. С
символа диеза (#), если он не кавычках, начинается комментарий,
заканчивающийся концом строки. Если в поле нужно использовать символы
пробела и диеза, то их нужно заключить в двойные кавычки ("). Любая пустая
строка (после удаления комментариев) игнорируется. Непустые строки могут
быть трёх типов: строки правил, строки поясов и строки ссылок.
.PP
Названия должны быть на английском, не зависят от регистра. Они используются
в разных контекстах и включают имена месяца, дня недели и ключевые слова,
например, \fBmaximum\fP, \fBonly\fP, \fBRolling\fP и \fBZone\fP. Имена могут быть
сокращены посредством пропуска всего кроме начального префикса; любое
сокращение должно быть недвусмысленным в контексте.
.PP
Строка правила имеет вид
.nf
.ti +.5i
.ta \w'Rule\0\0'u +\w'NAME\0\0'u +\w'FROM\0\0'u +\w'1973\0\0'u +\w'TYPE\0\0'u +\w'Apr\0\0'u +\w'lastSun\0\0'u +\w'2:00w\0\0'u +\w'1:00d\0\0'u
.sp
Rule	NAME	FROM	TO	TYPE	IN	ON	AT	SAVE	LETTER/S
.sp
Например:
.ti +.5i
.sp
Rule	US	1967	1973	\-	Apr	lastSun	2:00w	1:00	D
.sp
.fi
Описание полей, из которых состоит строка правила:
.TP  "\w'LETTER/S'u"
\fBNAME\fP
Имя списка правил, в который входит эта строка. Оно должно начинаться не с
цифры ASCII или
.q \-
или
.q + .
Для возможных расширений в будущем незакавыченное имя не должно содержать
символы
.q !$%&'()*,/:;<=>?@[\e]^`{|}~ .
.TP 
\fBFROM\fP
Первый год, в котором применяется данное правило. Можно задавать любое
знаковое целое значение года; предполагается использование Григорианского
календаря с нулевым годом перед первым. Слово \fIminimum\fP (или аббревиатура)
означает бесконечное прошлое. Слово \fImaximum\fP (или аббревиатура) означает
бесконечное будущее. Правила могут описывать времена, непредставимые как
значения времени, такие времена игнорируются; это делает правила
переносимыми между машинами с различными типами значений времени.
.TP 
\fBTO\fP
Последний год, в котором применяется данное правило. Вдобавок к \fBminimum\fP и
\fBmaximum\fP (описанным выше), может использоваться слово \fBonly\fP (или
аббревиатура), которое означает повторение значения из поля \fBFROM\fP.
.TP 
\fBTYPE\fP
Должно быть равно
.q \-
и оставлено для совместимости со старыми версиями \fBzic\fP, которые не
поддерживают тип года.
.TP 
\fBIN\fP
Название месяца, в котором начинает действовать правило. Название месяца
может быть аббревиатурой.
.TP 
\fBON\fP
День, в котором начинает действовать правило. Возможные формы записи:
.nf
.in +.5i
.sp
.ta \w'Sun<=25\0\0'u
5	пятый день месяца
lastSun	последнее воскресенье месяца
lastMon	последний понедельник месяца
Sun>=8	первое воскресенье после 8\-го числа включительно
Sun<=25	последнее воскресенье перед 25\-м включительно
.fi
.in -.5i
.sp
Название дня недели (например, \fBSunday\fP) или название дня недели, перед
которым указывается
.q last
(например, \fBlastSunday\fP), может быть аббревиатурой или писаться
полностью. Заметим, что в поле \fBON\fP не должно быть пробелов.
.TP 
\fBAT\fP
Время дня, с которого начинает действовать правило. Возможные формы записи:
.nf
.in +.5i
.sp
.ta \w'00:19:32.13\0\0'u
2	время в часах
2:00	время в часах и минутах
01:28:14	время в часах, минутах и секундах
15:00	время в 24\-часовом формате
     	(для времени после полудня)
260:00	260 часов после 00:00
\-2:30	2.5 часа до 00:00
\-	эквивалентно 0
.fi
.in -.5i
.sp
где час 0 означает полночь и начало нового дня, а час 24 означает полночь и
конец дня. Любая из этих форм может заканчиваться символом \fBw\fP, если это
местное «по настенным часам»
.q "wall clock"
время, \fBs\fP, если это локальное «стандартное» время,
.q standard
или \fIu\fP (или \fIg\fP, или \fIz\fP), если это универсальное время; при отсутствии
временного индикатора предполагается, что это местное время. Смысл в том,
чтобы строка правила описывала моменты времени, когда часы/календарь,
установленный в тип времени, указанном в поле \fBAT\fP, будут показывать
заданный день и время суток.
.TP 
\fBSAVE\fP
Количество времени, которое будет добавлено к локальному стандартному
времени при начале действия правила. Это поле имеет тот же формат, что и
поле \fBAT\fP, (хотя, конечно, при этом суффиксы \fIw\fP и \fIs\fP не
используются). Допускаются отрицательные смещения; например, в Ирландии
переход на летнее время проводят зимой и он задаётся как отрицательное
смещение относительно стандартного ирландского времени. Смещение просто
добавляется к стандартному времени; например, \fBzic\fP не делает различия
между 10:30 по стандартному времени плюс 0:30 \fBSAVE\fP и 10:00 стандартного
времени плюс 1:00 \fBSAVE\fP.
.TP 
\fBLETTER/S\fP
Переменная часть
.q "variable part"
(например,
.q S
или
.q D
в
.q EST
или
.q EDT )
аббревиатуры часового пояса, который используется при действии правила. В
этом поле символ
.q \- ,
указывает, что переменная часть равна null.
.PP
Строка часового пояса имеет вид
.sp
.nf
.ti +.5i
.ta \w'Zone\0\0'u +\w'Asia/Amman\0\0'u +\w'UTOFF\0\0'u +\w'Jordan\0\0'u +\w'FORMAT\0\0'u
Zone	NAME	UTOFF	RULES	FORMAT	[UNTIL]
.sp
Например:
.sp
.ti +.5i
Zone	Asia/Amman	2:00	Jordan	EE%sT	2017 Oct 27 01:00
.sp
.fi
Описание полей, из которых состоит строка часового пояса:
.TP  "\w'UTOFF'u"
\fBNAME\fP
Название часового пояса. Это название используется при создании файла с
информацией о переводе времени в этом поясе. В нём не должно содержаться
компонентов имени файла
.q .\(dq
или
.q .. ;
компонент имени файла — это максимальная подстрока, которая не содержит
.q / .
.TP 
\fBUTOFF\fP
Время, которое нужно добавить к UT, чтобы получить стандартное время. Это
поле имеет тот же формат, что и поля \fBAT\fP и \fBSAVE\fP в строках правил. Если
нужно отнять какое\-то время от UT, введите знак минуса в начале поля.
.TP 
\fBRULES\fP
Название правил, которые применяются в часовом поясе, или, иначе говоря,
поле в том же формате что и столбец SAVE в строке правила, задающей
количество времени, которое нужно добавить к локальному стандартному времени
и указывающее, будет ли получаемое время стандартным или летним. Если это
поле равно \fB\-\fP, то всегда используется стандартное время. Если указано
количество времени, то учитывается только сумма стандартного и это
количество.
.TP 
\fBFORMAT\fP
Формат аббревиатур часовых поясов. Пара символов \fB%s\fP используется как
положение переменной части
.q "variable part"
аббревиатуры часового пояса. Также в формате можно использовать пару
символов \fB%z\fP для обозначения смещения UT в виде \(+-\fIhh\fP, \(+-\fIhhmm\fP или
\(+-\fIhhmmss\fP; используется самая короткая форма, при которой не теряется
информация, где \fIhh\fP, \fImm\fP и \fIss\fP это часы, минуты и секунды восточнее
(+) или западнее (\(mi) UT. Косая черта (/) разделяет стандартную
аббревиатуру и аббревиатуру летнего времени. Для соответствия POSIX
аббревиатура часового пояса должна содержать только буквенно\-числовые
символы ASCII
.q +
и
.q \- .
.TP 
\fBUNTIL\fP
Время, с которого изменяются смещение UT или правила изменения
расположения. Оно задаётся как ГОД [МЕСЯЦ [ДЕНЬ [ВРЕМЯ]]]. Если оно задано,
то информация о часовом поясе формируется из заданного смещения UT и правила
смены до заданного времени, которое учитывается согласно правилам,
действовавшим до перехода. Месяц, день и время суток имеют тот же формат,
что и поля IN, ON и AT в правиле; последние поля могут не задаваться, а по
умолчанию для пропущенных полей действуют самые возможные ранние значения.
.IP
Следующей должна быть строка продления
.q continuation
; она имеет тот же формат, что и строка часового пояса, за исключением того,
что в строке пропускается
.q Zone
и название, так как строка продления будет задавать информацию, начиная со
времени, указанном в информации
.q until
из предыдущей строки в файле, использованном предыдущей строкой. Строки
продления могут содержать информацию
.q until
, как строки поясов, показывающую, что следующая строка имеет продолжение.
.PP
Если пояс изменяется в тот же момент, что и правило вступает в действие в
более раннем поясе или строке продолжения, то правило игнорируется. В
одиночном поясе является ошибкой, если два правила вступают в силу в один и
тот же момент времени или, если смена двух поясов происходит в один и тот же
момент времени.
.PP
Строка ссылки имеет вид
.sp
.nf
.ti +.5i
.ta \w'Link\0\0'u +\w'Europe/Istanbul\0\0'u
Link	TARGET	LINK\-NAME
.sp
Например:
.sp
.ti +.5i
Link	Europe/Istanbul	Asia/Istanbul
.sp
.fi
Поле \fBTARGET\fP должно иметь значение как у поля \fBNAME\fP из какой\-нибудь
строки пояса. Поле \fBLINK\-NAME\fP используется для задания альтернативного
имени этого часового пояса; оно имеет тот же синтаксис что и поле \fBNAME\fP в
строке пояса.
.PP
За исключением строк продления, строки могут располагаться в любом
порядке. Однако поведение не определено, если несколько поясов или строк
ссылок определяют одно имя, или если источник одной строки ссылки является
назначением другой.
.PP
Строки файла, описывающего високосные секунды, имеют вид:
.nf
.ti +.5i
.ta \w'Leap\0\0'u +\w'YEAR\0\0'u +\w'MONTH\0\0'u +\w'DAY\0\0'u +\w'HH:MM:SS\0\0'u +\w'CORR\0\0'u
.sp
Leap	YEAR	MONTH	DAY	HH:MM:SS	CORR	R/S
.sp
Например:
.ti +.5i
.sp
Leap	2016	Dec	31	23:59:60	+	S
.sp
.fi
Поля \fBYEAR\fP, \fBMONTH\fP, \fBDAY\fP и \fBHH:MM:SS\fP задают время, когда случается
високосная секунда. Поле \fBCORR\fP должно содержать
.q +
, если секунда добавляется, или
.q \-
если секунда пропускается. Поле \fBR/S\fP должно равняться
.q Stationary
(в виде аббревиатуры), если время високосной секунды, заданное другими
полями, должно интерпретироваться как UTC, или
.q Rolling
(в виде аббревиатуры), если время високосной секунды, заданное другими
полями, должно интерпретироваться как местное время.
.SH "РАСШИРЕННЫЙ ПРИМЕР"
Вот расширенный пример входных данных \fBzic\fP, в котором показано много
разных свойств. В этом примере правила EU — для Евросоюза и его
предшественника — Европейского сообщества (EC).
.br
.ne 22
.nf
.in +2m
.ta \w'# Rule\0\0'u +\w'NAME\0\0'u +\w'FROM\0\0'u +\w'1973\0\0'u +\w'TYPE\0\0'u +\w'Apr\0\0'u +\w'lastSun\0\0'u +\w'2:00\0\0'u +\w'SAVE\0\0'u
.sp
# Rule	NAME	FROM	TO	TYPE	IN	ON	AT	SAVE	LETTER/S
Rule	Swiss	1941	1942	\-	May	Mon>=1	1:00	1:00	S
Rule	Swiss	1941	1942	\-	Oct	Mon>=1	2:00	0	\-
.sp .5
Rule	EU	1977	1980	\-	Apr	Sun>=1	1:00u	1:00	S
Rule	EU	1977	only	\-	Sep	lastSun	1:00u	0	\-
Rule	EU	1978	only	\-	Oct	 1	1:00u	0	\-
Rule	EU	1979	1995	\-	Sep	lastSun	1:00u	0	\-
Rule	EU	1981	max	\-	Mar	lastSun	1:00u	1:00	S
Rule	EU	1996	max	\-	Oct	lastSun	1:00u	0	\-
.sp
.ta \w'# Zone\0\0'u +\w'Europe/Zurich\0\0'u +\w'0:34:08\0\0'u +\w'RULES\0\0'u +\w'FORMAT\0\0'u
# Zone	NAME	UTOFF	RULES	FORMAT	[UNTIL]
Zone	Europe/Zurich	0:34:08	\-	LMT	1853 Jul 16
		0:29:46	\-	BMT	1894 Jun
		1:00	Swiss	CE%sT	1981
		1:00	EU	CE%sT
.sp
Link	Europe/Zurich	Europe/Vaduz
.sp
.in
.fi
В этом примере часовой пояс называется Europe/Zurich, но он является
псевдонимом для Europe/Vaduz. Здесь показано, что Zurich был на 34 минуты и
8 секунд восточнее UT до 1853\-07\-16 00:00, пока смещение было не изменено
законодательно на 7\(de\|26\(fm\|22.50\(sd; хотя это работает до 0:29:45.50,
в входном формате нельзя отразить дробные секунды, поэтому здесь они
округлены. После 1894\-06\-01 00:00 смещение UT стало равно одному часу и
применяются швейцарские правила перехода на летнее время (определены в
строках, начинающиеся с
.q "Rule Swiss" )
\&. С 1981 года по настоящее время применяются правила EU для перехода на
летнее время, а смещение UTC осталось равным одному часу.
.PP
В 1941 и 1942 году летнее время начинается в первый понедельник мая в 01:00
и заканчивается в первый понедельник октября в 02:00. До 1981 года EU
правила перехода на летнее время здесь не применяются, но показаны для
полноты. Начиная с 1981 года летнее время начинается в последнее воскресенье
марта в 01:00 UTC. До 1995 года оно заканчивается в последнее воскресенье
сентября в 01:00 UTC, а с 1996 года изменено на последнее воскресенье
октября.
.PP
Для отображения сначала использовались, соответственно,
.q LMT
и
.q BMT
\&. С момента начали применения швейцарских правил, а позже европейских,
аббревиатурой часового пояса обозначение стандартного времени стало CET и
CEST для летнего времени.
.SH ФАЙЛЫ
.TP 
\fI/etc/localtime\fP
Файл локального часового пояса
.TP 
\fI/usr/share/zoneinfo\fP
Каталог по умолчанию с информацией о часовых поясах
.SH ЗАМЕЧАНИЯ
Для территорий, где имеется более двух типов местного времени, может
потребоваться использовать локальное стандартное время в поле \fBAT\fP самого
раннего правила перевода времени, чтобы быть уверенным, что самый ранний
перевод времени записан в выходной файл правильно.
.PP
Если для определённого часового пояса увеличение времени, вызванное началом
летнего времени, совпадает и равно уменьшению времени, вызванное изменением
в смещении UT, то \fBzic\fP делает один переход на летнее время по новому
смещению UT (без изменения местного времени). Чтобы получить раздельные
переходы, используйте несколько строк продления поясов, задающих моменты
перехода с помощью универсального времени.
.SH "СМОТРИТЕ ТАКЖЕ"
\fBtzfile\fP(5), \fBzdump\fP(8)
.\" This file is in the public domain, so clarified as of
.\" 2009-05-17 by Arthur David Olson.
